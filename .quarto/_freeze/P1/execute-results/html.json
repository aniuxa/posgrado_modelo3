{
  "hash": "f5173268ba7fb0020bc1eb2d44e1d317",
  "result": {
    "markdown": "# Introducción: `{dplyr}`\n\n## Paquetes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif (!require(\"pacman\")) install.packages(\"pacman\")#instala pacman si se requiere\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: pacman\n```\n:::\n\n```{.r .cell-code}\npacman::p_load(tidyverse,\n               readxl,\n               writexl, \n               haven,\n               sjlabelled, \n               janitor,\n               infer, \n               ggpubr,\n               magrittr,\n               gt)\n```\n:::\n\n\n## Cargando los datos\n\nDesde STATA\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntlaxt322<- haven::read_dta(\"./datos/tlaxt322.dta\")\n```\n:::\n\n\nDesde Excel:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nICI_2021 <- readxl::read_excel(\"./datos/ICI_2021.xlsx\",\n                               sheet = \"para_importar\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNew names:\n• `` -> `...2`\n```\n:::\n:::\n\n\n## Un poquito de `{dplyr}` y limpieza\n\n### Primero, los pipes\n\nR utiliza dos pipes el nativo `|>` y el pipe que está en `{dplyr}` `%>%`. Algunas de las diferencias las puedes checar acá <https://eliocamp.github.io/codigo-r/2021/05/r-pipa-nativa/>\n\nEn estas prácticas utilizaremos el segundo, pero son muy parecidos y para que esta instructora recicle algunos de sus códigos viejos. Pero funcionan igual:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntlaxt322|> #pipe nativo, no necesita instalación\n  head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 114\n  r_def           loc   mun   est est_d…¹ est_d…²  ageb t_loc…³ t_loc…⁴ cd_a    \n  <dbl+lbl>     <dbl> <dbl> <dbl>   <dbl>   <dbl> <dbl> <dbl+l> <dbl+l> <dbl+lb>\n1 0 [Entrevist…    NA    31    20     413      NA     0 2 [Loc… NA      39 [Tla…\n2 0 [Entrevist…    NA    31    20     413      NA     0 2 [Loc… NA      39 [Tla…\n3 0 [Entrevist…    NA    31    20     413      NA     0 2 [Loc… NA      39 [Tla…\n4 0 [Entrevist…    NA    31    20     413      NA     0 2 [Loc… NA      39 [Tla…\n5 0 [Entrevist…    NA    31    20     413      NA     0 2 [Loc… NA      39 [Tla…\n6 0 [Entrevist…    NA    31    20     413      NA     0 2 [Loc… NA      39 [Tla…\n# … with 104 more variables: ent <dbl+lbl>, con <dbl>, upm <dbl>,\n#   d_sem <dbl+lbl>, n_pro_viv <dbl>, v_sel <dbl+lbl>, n_hog <dbl+lbl>,\n#   h_mud <dbl+lbl>, n_ent <dbl+lbl>, per <dbl+lbl>, n_ren <dbl+lbl>,\n#   c_res <dbl+lbl>, par_c <dbl>, sex <dbl+lbl>, eda <dbl>, nac_dia <dbl+lbl>,\n#   nac_mes <dbl+lbl>, nac_anio <dbl>, l_nac_c <dbl+lbl>, cs_p12 <dbl+lbl>,\n#   cs_p13_1 <dbl+lbl>, cs_p13_2 <dbl+lbl>, cs_p14_c <chr>, cs_p15 <dbl+lbl>,\n#   cs_p16 <dbl+lbl>, cs_p17 <dbl+lbl>, n_hij <dbl+lbl>, e_con <dbl+lbl>, …\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntlaxt322 %>%  #pipe de dplyr, necesita instalación de dplyr en tidyverse\n  head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 114\n  r_def           loc   mun   est est_d…¹ est_d…²  ageb t_loc…³ t_loc…⁴ cd_a    \n  <dbl+lbl>     <dbl> <dbl> <dbl>   <dbl>   <dbl> <dbl> <dbl+l> <dbl+l> <dbl+lb>\n1 0 [Entrevist…    NA    31    20     413      NA     0 2 [Loc… NA      39 [Tla…\n2 0 [Entrevist…    NA    31    20     413      NA     0 2 [Loc… NA      39 [Tla…\n3 0 [Entrevist…    NA    31    20     413      NA     0 2 [Loc… NA      39 [Tla…\n4 0 [Entrevist…    NA    31    20     413      NA     0 2 [Loc… NA      39 [Tla…\n5 0 [Entrevist…    NA    31    20     413      NA     0 2 [Loc… NA      39 [Tla…\n6 0 [Entrevist…    NA    31    20     413      NA     0 2 [Loc… NA      39 [Tla…\n# … with 104 more variables: ent <dbl+lbl>, con <dbl>, upm <dbl>,\n#   d_sem <dbl+lbl>, n_pro_viv <dbl>, v_sel <dbl+lbl>, n_hog <dbl+lbl>,\n#   h_mud <dbl+lbl>, n_ent <dbl+lbl>, per <dbl+lbl>, n_ren <dbl+lbl>,\n#   c_res <dbl+lbl>, par_c <dbl>, sex <dbl+lbl>, eda <dbl>, nac_dia <dbl+lbl>,\n#   nac_mes <dbl+lbl>, nac_anio <dbl>, l_nac_c <dbl+lbl>, cs_p12 <dbl+lbl>,\n#   cs_p13_1 <dbl+lbl>, cs_p13_2 <dbl+lbl>, cs_p14_c <chr>, cs_p15 <dbl+lbl>,\n#   cs_p16 <dbl+lbl>, cs_p17 <dbl+lbl>, n_hij <dbl+lbl>, e_con <dbl+lbl>, …\n```\n:::\n:::\n\n\n### Limpieza de nombres con `{janitor}`\n\nEste paso también nos permitirá enseñar otro *pipe* que está en el paquete `{magrittr}`.\n\nLos nombres de una base de datos son los nombres de las columnas.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(tlaxt322)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  [1] \"r_def\"      \"loc\"        \"mun\"        \"est\"        \"est_d_tri\" \n  [6] \"est_d_men\"  \"ageb\"       \"t_loc_tri\"  \"t_loc_men\"  \"cd_a\"      \n [11] \"ent\"        \"con\"        \"upm\"        \"d_sem\"      \"n_pro_viv\" \n [16] \"v_sel\"      \"n_hog\"      \"h_mud\"      \"n_ent\"      \"per\"       \n [21] \"n_ren\"      \"c_res\"      \"par_c\"      \"sex\"        \"eda\"       \n [26] \"nac_dia\"    \"nac_mes\"    \"nac_anio\"   \"l_nac_c\"    \"cs_p12\"    \n [31] \"cs_p13_1\"   \"cs_p13_2\"   \"cs_p14_c\"   \"cs_p15\"     \"cs_p16\"    \n [36] \"cs_p17\"     \"n_hij\"      \"e_con\"      \"cs_p20a_1\"  \"cs_p20a_c\" \n [41] \"cs_p20b_1\"  \"cs_p20b_c\"  \"cs_p20c_1\"  \"cs_ad_mot\"  \"cs_p21_des\"\n [46] \"cs_ad_des\"  \"cs_nr_mot\"  \"cs_p23_des\" \"cs_nr_ori\"  \"ur\"        \n [51] \"zona\"       \"salario\"    \"fac_tri\"    \"fac_men\"    \"clase1\"    \n [56] \"clase2\"     \"clase3\"     \"pos_ocu\"    \"seg_soc\"    \"rama\"      \n [61] \"c_ocu11c\"   \"ing7c\"      \"dur9c\"      \"emple7c\"    \"medica5c\"  \n [66] \"buscar5c\"   \"rama_est1\"  \"rama_est2\"  \"dur_est\"    \"ambito1\"   \n [71] \"ambito2\"    \"tue1\"       \"tue2\"       \"tue3\"       \"busqueda\"  \n [76] \"d_ant_lab\"  \"d_cexp_est\" \"dur_des\"    \"sub_o\"      \"s_clasifi\" \n [81] \"remune2c\"   \"pre_asa\"    \"tip_con\"    \"dispo\"      \"nodispo\"   \n [86] \"c_inac5c\"   \"pnea_est\"   \"niv_ins\"    \"eda5c\"      \"eda7c\"     \n [91] \"eda12c\"     \"eda19c\"     \"hij5c\"      \"domestico\"  \"anios_esc\" \n [96] \"hrsocup\"    \"ingocup\"    \"ing_x_hrs\"  \"tpg_p8a\"    \"tcco\"      \n[101] \"cp_anoc\"    \"imssissste\" \"ma48me1sm\"  \"p14apoyos\"  \"scian\"     \n[106] \"t_tra\"      \"emp_ppal\"   \"tue_ppal\"   \"trans_ppal\" \"mh_fil2\"   \n[111] \"mh_col\"     \"sec_ins\"    \"tipo\"       \"mes_cal\"   \n```\n:::\n\n```{.r .cell-code}\nnames(ICI_2021)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"País\"                                                                  \n [2] \"...2\"                                                                  \n [3] \"Protección de derechos humanos\"                                        \n [4] \"Homicidios dolosos\"                                                    \n [5] \"Confianza en la policía\"                                               \n [6] \"Independencia del poder judicial\"                                      \n [7] \"Protección de derechos de propiedad\"                                   \n [8] \"Tiempo para resolver quiebras\"                                         \n [9] \"Cumplimiento de contratos\"                                             \n[10] \"Índice de Estado de Derecho\"                                           \n[11] \"Índice de Paz Global\"                                                  \n[12] \"Contaminación del aire\"                                                \n[13] \"Emisiones de CO2\"                                                      \n[14] \"Recursos hídricos renovables\"                                          \n[15] \"Áreas naturales protegidas\"                                            \n[16] \"Superficie forestal perdida\"                                           \n[17] \"Uso de pesticidas\"                                                     \n[18] \"Fuentes de energía no contaminantes\"                                   \n[19] \"Índice de vulnerabilidad a efectos del cambio climático\"               \n[20] \"Índice de Gini\"                                                        \n[21] \"Índice Global de Brecha de Género\"                                     \n[22] \"Mujeres en la PEA\"                                                     \n[23] \"Dependientes de la PEA\"                                                \n[24] \"Acceso a agua potable\"                                                 \n[25] \"Acceso a alcantarillado\"                                               \n[26] \"Analfabetismo\"                                                         \n[27] \"Escolaridad promedio\"                                                  \n[28] \"Calidad educativa\"                                                     \n[29] \"Esperanza de vida\"                                                     \n[30] \"Mortalidad infantil\"                                                   \n[31] \"Cobertura de vacunación\"                                               \n[32] \"Médicos y médicas\"                                                     \n[33] \"Gasto en salud per cápita\"                                             \n[34] \"Gasto en salud por cuenta propia\"                                      \n[35] \"Estabilidad política y ausencia de violencia\"                          \n[36] \"Interferencia militar en el Estado de derecho o en el proceso político\"\n[37] \"Libertades civiles\"                                                    \n[38] \"Índice de Percepción de Corrupción\"                                    \n[39] \"Disponibilidad de información pública\"                                 \n[40] \"Participación electoral\"                                               \n[41] \"Equidad en los congresos\"                                              \n[42] \"Índice de efectividad del gobierno\"                                    \n[43] \"Miembro de la Alianza para el Gobierno Abierto\"                        \n[44] \"Índice de desarrollo de Gobierno Electrónico\"                          \n[45] \"Facilidad para abrir una empresa\"                                      \n[46] \"Tiempo para preparar y pagar impuestos\"                                \n[47] \"Ingresos fiscales\"                                                     \n[48] \"Finanzas sanas\"                                                        \n[49] \"Carga impositiva\"                                                      \n[50] \"Edad efectiva de retiro\"                                               \n[51] \"Flexibilidad de las leyes laborales\"                                   \n[52] \"Productividad media del trabajo\"                                       \n[53] \"Valor agregado de la industria\"                                        \n[54] \"Índice de transparencia y regulación de la propiedad privada\"          \n[55] \"Crecimiento del PIB\"                                                   \n[56] \"Crecimiento promedio del PIB\"                                          \n[57] \"Inflación\"                                                             \n[58] \"Inflación promedio\"                                                    \n[59] \"Desempleo\"                                                             \n[60] \"Deuda externa\"                                                         \n[61] \"Calificación de deuda\"                                                 \n[62] \"Reservas\"                                                              \n[63] \"Libertad económica\"                                                    \n[64] \"Índice Riesgos de seguridad energética\"                                \n[65] \"Líneas móviles\"                                                        \n[66] \"Usuarios de internet\"                                                  \n[67] \"Servidores de internet seguros\"                                        \n[68] \"Flujo de pasajeros aéreos\"                                             \n[69] \"Índice de desempeño logístico (transporte)\"                            \n[70] \"Tráfico portuario de contenedores\"                                     \n[71] \"Penetración del sistema financiero privado\"                            \n[72] \"Capitalización del mercado de valores\"                                 \n[73] \"Socios comerciales efectivos\"                                          \n[74] \"Apertura comercial\"                                                    \n[75] \"Diversificación de las exportaciones\"                                  \n[76] \"Diversificación de las importaciones\"                                  \n[77] \"Libertad comercial\"                                                    \n[78] \"Inversión extranjera directa (neta)\"                                   \n[79] \"Inversión Extranjera Directa neta promedio\"                            \n[80] \"Ingresos por turismo\"                                                  \n[81] \"Gasto en investigación y desarrollo\"                                   \n[82] \"Coeficiente de invención\"                                              \n[83] \"Artículos científicos y técnicos\"                                      \n[84] \"Exportaciones de alta tecnología\"                                      \n[85] \"Índice de Complejidad Económica\"                                       \n[86] \"Empresas ISO 9001\"                                                     \n[87] \"PIB en servicios\"                                                      \n[88] \"0\"                                                                     \n[89] \"Inversión (FBCF)\"                                                      \n[90] \"Talento\"                                                               \n```\n:::\n:::\n\n\nComo vemos en las bases hay mayúsculas, caracteres especiales y demás. Esto lo podemos cambiar\n\n\n::: {.cell}\n\n```{.r .cell-code}\nICI_2021<-ICI_2021 %>% \n  janitor::clean_names()\n\nnames(ICI_2021)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"pais\"                                                                  \n [2] \"x2\"                                                                    \n [3] \"proteccion_de_derechos_humanos\"                                        \n [4] \"homicidios_dolosos\"                                                    \n [5] \"confianza_en_la_policia\"                                               \n [6] \"independencia_del_poder_judicial\"                                      \n [7] \"proteccion_de_derechos_de_propiedad\"                                   \n [8] \"tiempo_para_resolver_quiebras\"                                         \n [9] \"cumplimiento_de_contratos\"                                             \n[10] \"indice_de_estado_de_derecho\"                                           \n[11] \"indice_de_paz_global\"                                                  \n[12] \"contaminacion_del_aire\"                                                \n[13] \"emisiones_de_co2\"                                                      \n[14] \"recursos_hidricos_renovables\"                                          \n[15] \"areas_naturales_protegidas\"                                            \n[16] \"superficie_forestal_perdida\"                                           \n[17] \"uso_de_pesticidas\"                                                     \n[18] \"fuentes_de_energia_no_contaminantes\"                                   \n[19] \"indice_de_vulnerabilidad_a_efectos_del_cambio_climatico\"               \n[20] \"indice_de_gini\"                                                        \n[21] \"indice_global_de_brecha_de_genero\"                                     \n[22] \"mujeres_en_la_pea\"                                                     \n[23] \"dependientes_de_la_pea\"                                                \n[24] \"acceso_a_agua_potable\"                                                 \n[25] \"acceso_a_alcantarillado\"                                               \n[26] \"analfabetismo\"                                                         \n[27] \"escolaridad_promedio\"                                                  \n[28] \"calidad_educativa\"                                                     \n[29] \"esperanza_de_vida\"                                                     \n[30] \"mortalidad_infantil\"                                                   \n[31] \"cobertura_de_vacunacion\"                                               \n[32] \"medicos_y_medicas\"                                                     \n[33] \"gasto_en_salud_per_capita\"                                             \n[34] \"gasto_en_salud_por_cuenta_propia\"                                      \n[35] \"estabilidad_politica_y_ausencia_de_violencia\"                          \n[36] \"interferencia_militar_en_el_estado_de_derecho_o_en_el_proceso_politico\"\n[37] \"libertades_civiles\"                                                    \n[38] \"indice_de_percepcion_de_corrupcion\"                                    \n[39] \"disponibilidad_de_informacion_publica\"                                 \n[40] \"participacion_electoral\"                                               \n[41] \"equidad_en_los_congresos\"                                              \n[42] \"indice_de_efectividad_del_gobierno\"                                    \n[43] \"miembro_de_la_alianza_para_el_gobierno_abierto\"                        \n[44] \"indice_de_desarrollo_de_gobierno_electronico\"                          \n[45] \"facilidad_para_abrir_una_empresa\"                                      \n[46] \"tiempo_para_preparar_y_pagar_impuestos\"                                \n[47] \"ingresos_fiscales\"                                                     \n[48] \"finanzas_sanas\"                                                        \n[49] \"carga_impositiva\"                                                      \n[50] \"edad_efectiva_de_retiro\"                                               \n[51] \"flexibilidad_de_las_leyes_laborales\"                                   \n[52] \"productividad_media_del_trabajo\"                                       \n[53] \"valor_agregado_de_la_industria\"                                        \n[54] \"indice_de_transparencia_y_regulacion_de_la_propiedad_privada\"          \n[55] \"crecimiento_del_pib\"                                                   \n[56] \"crecimiento_promedio_del_pib\"                                          \n[57] \"inflacion\"                                                             \n[58] \"inflacion_promedio\"                                                    \n[59] \"desempleo\"                                                             \n[60] \"deuda_externa\"                                                         \n[61] \"calificacion_de_deuda\"                                                 \n[62] \"reservas\"                                                              \n[63] \"libertad_economica\"                                                    \n[64] \"indice_riesgos_de_seguridad_energetica\"                                \n[65] \"lineas_moviles\"                                                        \n[66] \"usuarios_de_internet\"                                                  \n[67] \"servidores_de_internet_seguros\"                                        \n[68] \"flujo_de_pasajeros_aereos\"                                             \n[69] \"indice_de_desempeno_logistico_transporte\"                              \n[70] \"trafico_portuario_de_contenedores\"                                     \n[71] \"penetracion_del_sistema_financiero_privado\"                            \n[72] \"capitalizacion_del_mercado_de_valores\"                                 \n[73] \"socios_comerciales_efectivos\"                                          \n[74] \"apertura_comercial\"                                                    \n[75] \"diversificacion_de_las_exportaciones\"                                  \n[76] \"diversificacion_de_las_importaciones\"                                  \n[77] \"libertad_comercial\"                                                    \n[78] \"inversion_extranjera_directa_neta\"                                     \n[79] \"inversion_extranjera_directa_neta_promedio\"                            \n[80] \"ingresos_por_turismo\"                                                  \n[81] \"gasto_en_investigacion_y_desarrollo\"                                   \n[82] \"coeficiente_de_invencion\"                                              \n[83] \"articulos_cientificos_y_tecnicos\"                                      \n[84] \"exportaciones_de_alta_tecnologia\"                                      \n[85] \"indice_de_complejidad_economica\"                                       \n[86] \"empresas_iso_9001\"                                                     \n[87] \"pib_en_servicios\"                                                      \n[88] \"x0\"                                                                    \n[89] \"inversion_fbcf\"                                                        \n[90] \"talento\"                                                               \n```\n:::\n:::\n\n\nSi quisiéramos que la acción quedará de un solo, podemos usar un pipe diferente:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntlaxt322%<>% \n  clean_names()\n\nnames(tlaxt322)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  [1] \"r_def\"      \"loc\"        \"mun\"        \"est\"        \"est_d_tri\" \n  [6] \"est_d_men\"  \"ageb\"       \"t_loc_tri\"  \"t_loc_men\"  \"cd_a\"      \n [11] \"ent\"        \"con\"        \"upm\"        \"d_sem\"      \"n_pro_viv\" \n [16] \"v_sel\"      \"n_hog\"      \"h_mud\"      \"n_ent\"      \"per\"       \n [21] \"n_ren\"      \"c_res\"      \"par_c\"      \"sex\"        \"eda\"       \n [26] \"nac_dia\"    \"nac_mes\"    \"nac_anio\"   \"l_nac_c\"    \"cs_p12\"    \n [31] \"cs_p13_1\"   \"cs_p13_2\"   \"cs_p14_c\"   \"cs_p15\"     \"cs_p16\"    \n [36] \"cs_p17\"     \"n_hij\"      \"e_con\"      \"cs_p20a_1\"  \"cs_p20a_c\" \n [41] \"cs_p20b_1\"  \"cs_p20b_c\"  \"cs_p20c_1\"  \"cs_ad_mot\"  \"cs_p21_des\"\n [46] \"cs_ad_des\"  \"cs_nr_mot\"  \"cs_p23_des\" \"cs_nr_ori\"  \"ur\"        \n [51] \"zona\"       \"salario\"    \"fac_tri\"    \"fac_men\"    \"clase1\"    \n [56] \"clase2\"     \"clase3\"     \"pos_ocu\"    \"seg_soc\"    \"rama\"      \n [61] \"c_ocu11c\"   \"ing7c\"      \"dur9c\"      \"emple7c\"    \"medica5c\"  \n [66] \"buscar5c\"   \"rama_est1\"  \"rama_est2\"  \"dur_est\"    \"ambito1\"   \n [71] \"ambito2\"    \"tue1\"       \"tue2\"       \"tue3\"       \"busqueda\"  \n [76] \"d_ant_lab\"  \"d_cexp_est\" \"dur_des\"    \"sub_o\"      \"s_clasifi\" \n [81] \"remune2c\"   \"pre_asa\"    \"tip_con\"    \"dispo\"      \"nodispo\"   \n [86] \"c_inac5c\"   \"pnea_est\"   \"niv_ins\"    \"eda5c\"      \"eda7c\"     \n [91] \"eda12c\"     \"eda19c\"     \"hij5c\"      \"domestico\"  \"anios_esc\" \n [96] \"hrsocup\"    \"ingocup\"    \"ing_x_hrs\"  \"tpg_p8a\"    \"tcco\"      \n[101] \"cp_anoc\"    \"imssissste\" \"ma48me1sm\"  \"p14apoyos\"  \"scian\"     \n[106] \"t_tra\"      \"emp_ppal\"   \"tue_ppal\"   \"trans_ppal\" \"mh_fil2\"   \n[111] \"mh_col\"     \"sec_ins\"    \"tipo\"       \"mes_cal\"   \n```\n:::\n:::\n\n\nMás de otros *pipes* <https://r4ds.had.co.nz/pipes.html>\n\n## `select()` y `filter()`\n\nEste es un recordatorio de que en `{dplyr}`, se filtran CASOS, es decir, líneas o renglones, y se seleccionan VARIABLES.\n\nPor ejemplo:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntlaxt322%>% \n  dplyr::select(sex, eda) %>% \n  dplyr::filter(eda>11)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 9,205 × 2\n   sex          eda\n   <dbl+lbl>  <dbl>\n 1 1 [Hombre]    34\n 2 2 [Mujer]     57\n 3 1 [Hombre]    71\n 4 1 [Hombre]    67\n 5 2 [Mujer]     60\n 6 2 [Mujer]     35\n 7 1 [Hombre]    39\n 8 1 [Hombre]    38\n 9 2 [Mujer]     33\n10 1 [Hombre]    14\n# … with 9,195 more rows\n```\n:::\n:::\n\n\nEn la documentación de la base de datos de la ENOE se nos señala que debemos quedarnos con quienes tienen entrevista completa `r_def==0` y con quiénes son habitante habituales `(c_res!=2\")`\n\nHagamos estos cambios:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntlaxt322%<>%\n  filter(r_def==0) %>% \n  filter(!c_res==2)\n```\n:::\n\n\n## Tabulados con `tabyl()`\n\nEl comando tabyl del paquete `{janitor}` nos sirve para hacer tabulados. Para que sean más bonitas, necesitaremos cambiar algunas de nuestras variables a sus datos etiquetados\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntlaxt322%>%\n  dplyr::mutate(sex=sjlabelled::as_label(sex))  %>%\n  janitor::tabyl(sex)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    sex    n   percent\n Hombre 5392 0.4767041\n  Mujer 5919 0.5232959\n```\n:::\n:::\n\n\nPara ver que esto es una distribución de frecuencias sería muy útil ver la proporción total, ello se realiza agregando un elemento más en nuestro código con una \"tubería\":\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntlaxt322%>%\n  mutate(sex=as_label(sex)) %>% \n  tabyl(sex) %>%\n  adorn_totals() #primer enchulamiento\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    sex     n   percent\n Hombre  5392 0.4767041\n  Mujer  5919 0.5232959\n  Total 11311 1.0000000\n```\n:::\n:::\n\n\nAhora, las proporciones son raras, y preferimos por los porcentajes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntlaxt322%>%\n  mutate(sex=as_label(sex)) %>% # cambia los valores de la variable a sus etiquetas\n  tabyl(sex) %>% # para hacer la tabla\n  adorn_totals() %>% # añade totales\n  adorn_pct_formatting()  # nos da porcentaje en lugar de proporción\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    sex     n percent\n Hombre  5392   47.7%\n  Mujer  5919   52.3%\n  Total 11311  100.0%\n```\n:::\n:::\n\n\nVamos a darle una \"ojeada\" a esta variable\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(tlaxt322$niv_ins)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n dbl+lbl [1:11311] 4, 2, 3, 3, 3, 4, 2, 3, 4, 2, 2, 2, 2, 3, 3, 2, 3, 2, 2,...\n @ label       : chr \"Clasificación de la población ocupada por nivel de instrucción\"\n @ format.stata: chr \"%12.0g\"\n @ labels      : Named num [1:6] 0 1 2 3 4 5\n  ..- attr(*, \"names\")= chr [1:6] \"No aplica\" \"Primaria incompleta\" \"Prrimaria completa\" \"Secundaria completa\" ...\n```\n:::\n:::\n\n\nHoy hacemos la tabla, con las etiquetas:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntlaxt322%>%\n  mutate(niv_ins=as_label(niv_ins)) %>% #esto sólo si hay etiquetas declaradas, recuerda\n  tabyl(niv_ins)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                   niv_ins    n      percent\n                 No aplica  714 0.0631243922\n       Primaria incompleta 2173 0.1921138715\n        Prrimaria completa 2025 0.1790292635\n       Secundaria completa 3201 0.2829988507\n Medio superior y superior 3190 0.2820263460\n           No especificado    8 0.0007072761\n```\n:::\n:::\n\n\nPara que no nos salgan las categorías sin datos podemos poner una opción dentro del comando \"tabyl()\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntlaxt322%>% \n  mutate(niv_ins=as_label(niv_ins)) %>% \n  tabyl(niv_ins, \n        show_missing_levels=F ) %>% # esta opción elimina los valores con 0\n  adorn_totals()  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                   niv_ins     n      percent\n                 No aplica   714 0.0631243922\n       Primaria incompleta  2173 0.1921138715\n        Prrimaria completa  2025 0.1790292635\n       Secundaria completa  3201 0.2829988507\n Medio superior y superior  3190 0.2820263460\n           No especificado     8 0.0007072761\n                     Total 11311 1.0000000000\n```\n:::\n:::\n\n\n### Cálculo de frecuencias\n\nLas tablas de doble entrada tiene su nombre porque en las columnas entran los valores de una variable categórica, y en las filas de una segunda. Básicamente es como hacer un conteo de todas las combinaciones posibles entre los valores de una variable con la otra.\n\nPor ejemplo, si quisiéramos combinar las dos variables que ya estudiamos lo podemos hacer, con una tabla de doble entrada:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntlaxt322%>% \n  mutate(niv_ins=as_label(niv_ins)) %>% # para que las lea como factor\n  mutate(sex=as_label(sex)) %>% # para que las lea como factor\n  tabyl(niv_ins, sex, show_missing_levels=F ) %>% # incluimos aquí\n  adorn_totals()  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                   niv_ins Hombre Mujer\n                 No aplica    389   325\n       Primaria incompleta   1066  1107\n        Prrimaria completa    950  1075\n       Secundaria completa   1450  1751\n Medio superior y superior   1533  1657\n           No especificado      4     4\n                     Total   5392  5919\n```\n:::\n:::\n\n\nObservamos que en cada celda confluyen los casos que comparten las mismas características:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntlaxt322%>%   \n    count(niv_ins==1 & sex==1) # nos da la segunda celda de la izquierda\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 2\n  `niv_ins == 1 & sex == 1`     n\n  <lgl>                     <int>\n1 FALSE                     10245\n2 TRUE                       1066\n```\n:::\n:::\n\n\n### Totales y porcentajes\n\nDe esta manera se colocan todos los datos. Si observa al poner la función \"adorn_totals()\" lo agregó como una nueva fila de totales, pero también podemos pedirle que agregue una columna de totales.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntlaxt322%>% \n  mutate(niv_ins=as_label(niv_ins)) %>% # para que las lea como factor\n  mutate(sex=as_label(sex)) %>% # para que las lea como factor\n  tabyl(niv_ins, sex, show_missing_levels=F ) %>% # incluimos aquí sex\n  adorn_totals(\"col\")  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                   niv_ins Hombre Mujer Total\n                 No aplica    389   325   714\n       Primaria incompleta   1066  1107  2173\n        Prrimaria completa    950  1075  2025\n       Secundaria completa   1450  1751  3201\n Medio superior y superior   1533  1657  3190\n           No especificado      4     4     8\n```\n:::\n:::\n\n\nO bien agregar los dos, introduciendo en el argumento `c(\"col\", \"row\")` un vector de caracteres de las dos opciones requeridas:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntlaxt322%>% \n  mutate(niv_ins=as_label(niv_ins)) %>% # para que las lea como factor\n  mutate(sex=as_label(sex)) %>% # para que las lea como factor\n  tabyl(niv_ins, sex, show_missing_levels=F ) %>% # incluimos aquí sexo\n  adorn_totals(c(\"col\", \"row\")) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                   niv_ins Hombre Mujer Total\n                 No aplica    389   325   714\n       Primaria incompleta   1066  1107  2173\n        Prrimaria completa    950  1075  2025\n       Secundaria completa   1450  1751  3201\n Medio superior y superior   1533  1657  3190\n           No especificado      4     4     8\n                     Total   5392  5919 11311\n```\n:::\n:::\n\n\nDel mismo modo, podemos calcular los porcentajes. Pero los podemos calcular de tres formas. Uno es que lo calculemos para los totales calculados para las filas, para las columnas o para el gran total poblacional.\n\nPara columnas tenemos el siguiente código y los siguientes resultados:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntlaxt322%>% \n  mutate(niv_ins=as_label(niv_ins)) %>% # para que las lea como factor\n  mutate(sex=as_label(sex)) %>% # para que las lea como factor\n  tabyl(niv_ins, sex, show_missing_levels=F ) %>% # incluimos aquí sexo\n  adorn_totals(c(\"col\", \"row\")) %>% \n  adorn_percentages(\"col\") %>% # Divide los valores entre el total de la columna\n  adorn_pct_formatting() # lo vuelve porcentaje\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                   niv_ins Hombre  Mujer  Total\n                 No aplica   7.2%   5.5%   6.3%\n       Primaria incompleta  19.8%  18.7%  19.2%\n        Prrimaria completa  17.6%  18.2%  17.9%\n       Secundaria completa  26.9%  29.6%  28.3%\n Medio superior y superior  28.4%  28.0%  28.2%\n           No especificado   0.1%   0.1%   0.1%\n                     Total 100.0% 100.0% 100.0%\n```\n:::\n:::\n\n\nCuando se hagan cuadros de distribuciones (que todas sus partes suman 100), los porcentajes pueden ser una gran ayuda para la interpretación, sobre todos cuando se comparar poblaciones de categorías de diferente tamaño. Por lo general, queremos que los cuadros nos den información de donde están los totales y su 100%, de esta manera el lector se puede guiar de porcentaje con respecto a qué está leyendo. En este caso, vemos que el 100% es común en la última fila.\n\nVeamos la diferencia de cómo podemos leer la misma celda, pero hoy, hemos calculado los porcentajes a nivel de fila:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntlaxt322%>% \n  mutate(niv_ins=as_label(niv_ins)) %>% # para que las lea como factor\n  mutate(sex=as_label(sex)) %>% # para que las lea como factor\n  tabyl(niv_ins, sex, show_missing_levels=F ) %>% \n  adorn_totals(c(\"col\", \"row\")) %>% \n  adorn_percentages(\"row\") %>% # Divide los valores entre el total de la fila\n  adorn_pct_formatting() # lo vuelve porcentaje\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                   niv_ins Hombre Mujer  Total\n                 No aplica  54.5% 45.5% 100.0%\n       Primaria incompleta  49.1% 50.9% 100.0%\n        Prrimaria completa  46.9% 53.1% 100.0%\n       Secundaria completa  45.3% 54.7% 100.0%\n Medio superior y superior  48.1% 51.9% 100.0%\n           No especificado  50.0% 50.0% 100.0%\n                     Total  47.7% 52.3% 100.0%\n```\n:::\n:::\n\n\nFinalmente, podemos calcular los porcentajes con referencia a la población total en análisis. Es decir la celda en la esquina inferior derecha de nuestra tabla original.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntlaxt322%>% \n  mutate(niv_ins=as_label(niv_ins)) %>% # para que las lea como factor\n  mutate(sex=as_label(sex)) %>% # para que las lea como factor\n  tabyl(niv_ins, sex, show_missing_levels=F ) %>% # incluimos aquí sexo\n  adorn_totals(c(\"col\", \"row\")) %>% \n   adorn_percentages(\"all\") %>% # Divide los valores entre el total de la población\n  adorn_pct_formatting() # lo vuelve porcentaje\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                   niv_ins Hombre Mujer  Total\n                 No aplica   3.4%  2.9%   6.3%\n       Primaria incompleta   9.4%  9.8%  19.2%\n        Prrimaria completa   8.4%  9.5%  17.9%\n       Secundaria completa  12.8% 15.5%  28.3%\n Medio superior y superior  13.6% 14.6%  28.2%\n           No especificado   0.0%  0.0%   0.1%\n                     Total  47.7% 52.3% 100.0%\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}